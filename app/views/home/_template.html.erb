<%= hidden_field_tag "clicked", "" %>
<%= hidden_field_tag "index", "" %>
<%= form_for :album, :url => {:controller => :albumes, :action => :create_album, :id => @template.id}, :html => {:multipart => true} do |f| %>
    <svg style="background-color: pink" version="1.1" height="450" width="800" id="templates-container" preserveAspectRatio="none">
      <defs>
        <% @shapes.each_with_index do |s, i| %>
            <pattern id="img<%= i + 1 %>" patternUnits="userSpaceOnUse" width="100" height="100">
              <image xlink:href="" x="0" y="0" width="100" height="100" id="bac-image-<%= i + 1 %>"/>
            </pattern>

        <% end %>
      </defs>
      <% @shapes.each_with_index do |s, c| %>
          <<%= s.type %> stroke-width="2" fill="white" stroke="black" width="<%= s.width %>" height="<%= s.height %>"
          r="<%= s.r %>"
          cy="<%= s.y %>" cx="<%= s.x %>" id="<%= s.type %><%= c + 1 %>" x="<%= s.x %>" y="<%= s.y %>" class="ga-svg
          droppable" alt="<%= c + 1 %>"
          onclick="<%= user_signed_in? ? 'open_dialog(this)' : 'open_file(this)' %>"/>
      <% end %>
    </svg>
    <% @shapes.each_with_index do |s, c| %>
        <%= file_field_tag "avatar#{c}", :style => "display: none" %>
        <%= hidden_field_tag "image#{ c + 1}", 0 %>
    <% end %>

    <%= f.submit "Save and Next", :class => "btn btn-primary" %>
<% end %>

<!-- Modal -->
<div id="myModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none">
  <%= render "shared/images_select" %>
</div>
<!-- Modal end -->

<%= file_field_tag "file_opener", :style => "display: none" %>

<%= render "home/template_js" %>